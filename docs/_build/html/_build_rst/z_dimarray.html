<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Old documentation &mdash; dimarray 0.1.7.dev-62ca5fa documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1.7.dev-62ca5fa',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="dimarray 0.1.7.dev-62ca5fa documentation" href="../index.html" />
    <link rel="up" title="Documentation" href="index.html" />
    <link rel="next" title="Comparisons with other packages" href="../comparison.html" />
    <link rel="prev" title="Indexing" href="indexing.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../comparison.html" title="Comparisons with other packages"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="indexing.html" title="Indexing"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">dimarray 0.1.7.dev-62ca5fa documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="old-documentation">
<span id="z-dimarray"></span><h1>Old documentation<a class="headerlink" href="#old-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="getting-started">
<span id="id1"></span><h2>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>A <strong>``DimArray``</strong> can be defined just like a numpy array, with
additional information about its axes, which can be given
via <cite>axes</cite> and <cite>dims</cite> parameters.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dimarray</span> <span class="kn">import</span> <span class="n">DimArray</span><span class="p">,</span> <span class="n">Dataset</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">DimArray</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">6.</span><span class="p">]],</span> <span class="n">axes</span><span class="o">=</span><span class="p">[[</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="s">&quot;b&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]],</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;dim0&#39;</span><span class="p">,</span><span class="s">&#39;dim1&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">dimarray: 6 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;dim0&#39;, &#39;dim1&#39;</span>
<span class="go">0 / dim0 (2): a to b</span>
<span class="go">1 / dim1 (3): 0 to 2</span>
<span class="go">array([[ 1.,  2.,  3.],</span>
<span class="go">       [ 4.,  5.,  6.]])</span>
</pre></div>
</div>
<p>Array data are stored in a <cite>values</cite> <strong>attribute</strong>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">values</span>
<span class="go">array([[ 1.,  2.,  3.],</span>
<span class="go">       [ 4.,  5.,  6.]])</span>
</pre></div>
</div>
<p>and axis names and values can be accessed straightforwardly, just like <cite>shape</cite> and <cite>ndim</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">dims</span>
<span class="go">(&#39;dim0&#39;, &#39;dim1&#39;)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">labels</span>   <span class="c"># same as (a.dim0, a.dim1)</span>
<span class="go">(array([&#39;a&#39;, &#39;b&#39;], dtype=object), array([0, 1, 2]))</span>
</pre></div>
</div>
<p><strong>Indexing</strong> works on labels just as expected, including <cite>slice</cite> and boolean array.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="go">5.0</span>
</pre></div>
</div>
<p>but integer-index is always possible via <cite>ix</cite> toogle between <cite>labels</cite>- and <cite>position</cite>-based indexing:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="go">5.0</span>
</pre></div>
</div>
<p>Numpy <strong>transformations</strong> are defined, and now accept axis name:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">&#39;dim0&#39;</span><span class="p">)</span>
<span class="go">dimarray: 3 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;dim1&#39;</span>
<span class="go">0 / dim1 (3): 0 to 2</span>
<span class="go">array([ 2.5,  3.5,  4.5])</span>
</pre></div>
</div>
<p>and can ignore <strong>missing values (nans)</strong> if asked to:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">dimarray: 5 non-null elements (1 null)</span>
<span class="go">dimensions: &#39;dim0&#39;, &#39;dim1&#39;</span>
<span class="go">0 / dim0 (2): a to b</span>
<span class="go">1 / dim1 (3): 0 to 2</span>
<span class="go">array([[  1.,   2.,  nan],</span>
<span class="go">       [  4.,   5.,   6.]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">&#39;dim0&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">dimarray: 3 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;dim1&#39;</span>
<span class="go">0 / dim1 (3): 0 to 2</span>
<span class="go">array([ 2.5,  3.5,  6. ])</span>
</pre></div>
</div>
<p>Having axis name and axis values allow on-the-fly <strong>axis alignment</strong> and
<strong>dimension broadcasting</strong> in basic operations (addition, etc...),
so that rules can be defined for nearly every sequence of operands.</p>
<p>Let&#8217;s define some axes on dimensions <cite>time</cite> and <cite>items</cite>, using the tuple form (name, values)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;time&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">1951</span><span class="p">,</span> <span class="mi">1952</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">incomplete_time</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;time&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">1952</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;items&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>see how two arrays with different time indices align, and how the missing year in the second array is replaced by nan:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">timeseries</span> <span class="o">=</span> <span class="n">DimArray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">time</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">incomplete_timeseries</span> <span class="o">=</span> <span class="n">DimArray</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">incomplete_time</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timeseries</span> <span class="o">+</span> <span class="n">incomplete_timeseries</span>
<span class="go">dimarray: 2 non-null elements (1 null)</span>
<span class="go">dimensions: &#39;time&#39;</span>
<span class="go">0 / time (3): 1950 to 1952</span>
<span class="go">array([  5.,  nan,   8.])</span>
</pre></div>
</div>
<p>If one of the operands lacks a dimension, it is automatically repeated (broadcast) to match the other operand&#8217;s shape. In this example, an array of weights is fixed in time, whereas the data to be weighted changes at each time step.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">DimArray</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">60</span><span class="p">]],</span> <span class="p">[</span><span class="n">items</span><span class="p">,</span> <span class="n">time</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">DimArray</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="n">items</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">*</span> <span class="n">weights</span>
<span class="go">dimarray: 6 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;items&#39;, &#39;time&#39;</span>
<span class="go">0 / items (2): a to b</span>
<span class="go">1 / time (3): 1950 to 1952</span>
<span class="go">array([[  2.,   4.,   6.],</span>
<span class="go">       [ 20.,  25.,  30.]])</span>
</pre></div>
</div>
<p>As a commodity, the <strong>`Dataset`</strong> class is an ordered dictionary of DimArrays which also maintains axis aligment</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">({</span><span class="s">&#39;data&#39;</span><span class="p">:</span><span class="n">data</span><span class="p">,</span> <span class="s">&#39;weights&#39;</span><span class="p">:</span><span class="n">weights</span><span class="p">,</span><span class="s">&#39;incomplete_timeseries&#39;</span><span class="p">:</span><span class="n">incomplete_timeseries</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span>
<span class="go">Dataset of 3 variables</span>
<span class="go">dimensions: &#39;items&#39;, &#39;time&#39;</span>
<span class="go">0 / items (2): a to b</span>
<span class="go">1 / time (3): 1950 to 1952</span>
<span class="go">weights: (&#39;items&#39;,)</span>
<span class="go">incomplete_timeseries: (&#39;time&#39;,)</span>
<span class="go">data: (&#39;items&#39;, &#39;time&#39;)</span>
</pre></div>
</div>
<p>It is one step away from creating a new DimArray from these various arrays, by broadcasting dimensions as needed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">to_array</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">&#39;variables&#39;</span><span class="p">)</span>
<span class="go">dimarray: 16 non-null elements (2 null)</span>
<span class="go">dimensions: &#39;variables&#39;, &#39;items&#39;, &#39;time&#39;</span>
<span class="go">0 / variables (3): weights to data</span>
<span class="go">1 / items (2): a to b</span>
<span class="go">2 / time (3): 1950 to 1952</span>
<span class="go">array([[[  2. ,   2. ,   2. ],</span>
<span class="go">        [  0.5,   0.5,   0.5]],</span>
</pre></div>
</div>
<blockquote>
<div><dl class="docutils">
<dt>[[  4. ,   nan,   5. ],</dt>
<dd>[  4. ,   nan,   5. ]],</dd>
<dt>[[  1. ,   2. ,   3. ],</dt>
<dd>[ 40. ,  50. ,  60. ]]])</dd>
</dl>
</div></blockquote>
<p>Note a shorter way of obtaining the above, if the only desired result is to align axes, would have been to use the <strong>`stack`</strong> method (see interactive help).</p>
<p>A natural I/O format for such an array is netCDF, common in geophysics, which rely on
the netCDF4 package. If netCDF4 is installed (much recommanded), a dataset can easily read and write to the netCDF format:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">write_nc</span><span class="p">(</span><span class="s">&#39;test.nc&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dimarray</span> <span class="kn">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">read_nc</span><span class="p">(</span><span class="s">&#39;test.nc&#39;</span><span class="p">,</span> <span class="s">&#39;incomplete_timeseries&#39;</span><span class="p">)</span>
<span class="go">dimarray: 2 non-null elements (1 null)</span>
<span class="go">dimensions: &#39;time&#39;</span>
<span class="go">0 / time (3): 1950 to 1952</span>
<span class="go">array([  4.,  nan,   5.])</span>
</pre></div>
</div>
<p>Additional novelty includes methods to reshaping an array in easy ways, very useful for high-dimensional data analysis.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">large_array</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span><span class="s">&#39;B&#39;</span><span class="p">,</span><span class="s">&#39;C&#39;</span><span class="p">,</span><span class="s">&#39;D&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">small_array</span> <span class="o">=</span> <span class="n">large_array</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span><span class="s">&#39;B&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">,</span><span class="s">&#39;D&#39;</span><span class="p">)</span>  <span class="c"># same as reshape(&#39;A,B&#39;,&#39;C,D&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">small_array</span>
<span class="go">dimarray: 40 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;A,B&#39;, &#39;C,D&#39;</span>
<span class="go">0 / A,B (4): (0, 0) to (1, 1)</span>
<span class="go">1 / C,D (10): (0, 0) to (4, 1)</span>
<span class="go">array([[ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9],</span>
<span class="go">       [10, 11, 12, 13, 14, 15, 16, 17, 18, 19],</span>
<span class="go">       [20, 21, 22, 23, 24, 25, 26, 27, 28, 29],</span>
<span class="go">       [30, 31, 32, 33, 34, 35, 36, 37, 38, 39]])</span>
</pre></div>
</div>
<p>And for things that pandas does better, such as pretty printing, I/O to many formats, and low-dimensional data analysis, just use the <strong>`to_pandas`</strong> method (see reverse <strong>`from_pandas`</strong>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">small_array</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="go">C     0       1       2       3       4</span>
<span class="go">D     0   1   0   1   0   1   0   1   0   1</span>
<span class="go">A B</span>
<span class="go">0 0   0   1   2   3   4   5   6   7   8   9</span>
<span class="go">  1  10  11  12  13  14  15  16  17  18  19</span>
<span class="go">1 0  20  21  22  23  24  25  26  27  28  29</span>
<span class="go">  1  30  31  32  33  34  35  36  37  38  39</span>
</pre></div>
</div>
</div>
<div class="section" id="under-the-hood">
<span id="id2"></span><h2>Under the hood<a class="headerlink" href="#under-the-hood" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="axis-object">
<span id="id3"></span><h2>Axis object<a class="headerlink" href="#axis-object" title="Permalink to this headline">¶</a></h2>
<p>Under the hood, information about axis names and values are stored under an <cite>axes</cite> attribute, for consistency with numpy and pandas. It is a custom list of __`Axis`__ objects:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">axes</span>
<span class="go">dimensions: &#39;dim0&#39;, &#39;dim1&#39;</span>
<span class="go">0 / dim0 (2): a to b</span>
<span class="go">1 / dim1 (3): 0 to 2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c"># by integer position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="s">&#39;dim0&#39;</span><span class="p">]</span> <span class="c"># by axis name (for pythonistas: list with overloaded __getitem__ property)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span>
<span class="go">dim0 (2): a to b</span>
</pre></div>
</div>
<p>An __`Axis`__ object itself has <cite>name</cite> and <cite>values</cite> attributes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;dim0&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">values</span>
<span class="go">array([&#39;a&#39;, &#39;b&#39;], dtype=object)</span>
</pre></div>
</div>
</div>
<div class="section" id="alternative-definitions-of-a-dimarray">
<span id="id4"></span><h2>Alternative definitions of a DimArray<a class="headerlink" href="#alternative-definitions-of-a-dimarray" title="Permalink to this headline">¶</a></h2>
<p>It can be passed directly via the <cite>axes=</cite> parameter to initialize a DimArray, or be passed as a list of tuples (<cite>axis name</cite>, <cite>axis values</cite>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">DimArray</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span> <span class="n">axes</span><span class="o">=</span><span class="p">[(</span><span class="s">&quot;dim0&quot;</span><span class="p">,[</span><span class="mi">4</span><span class="p">,</span><span class="s">&quot;a&quot;</span><span class="p">]),</span> <span class="p">(</span><span class="s">&quot;dim1&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">dimarray: 6 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;dim0&#39;, &#39;dim1&#39;</span>
<span class="go">0 / dim0 (2): 4 to a</span>
<span class="go">1 / dim1 (3): 0 to 2</span>
<span class="go">array([[1, 2, 3],</span>
<span class="go">       [4, 5, 6]])</span>
</pre></div>
</div>
<p>In another world (like in R), one could also have chosen <cite>dims</cite> instead of <cite>axes</cite>. <cite>numpy</cite> has decided otherwise and was followed by <cite>pandas</cite>, so <cite>dimarray</cite> will just stick to it to reduce confusion.</p>
<p>The convention chosen in <cite>dimarray</cite> is to refer to axis names as <cite>dims</cite>  (for dimensions) and to axis values as <cite>labels</cite>. This choice may seem a bit arbitrary, and to a certain extent it is, but it also has some internal logics. In particular, <cite>dimensions</cite> in the physical sense of the term refers to things with units, such time or space dimensions. A dimension is more like a fundamental property of an axis. It is conserved by indexing or slicing along an axis, and it determines whether two axes can be aligned or concatenated. <cite>labels</cite> may be more awkward when actually thinking about axis <cite>values</cite>, but it makes full sense when realizing that axis values serve as labelling the elements of an array elements. There is even a handy package whose name is drawn from it (<cite>larry</cite>, for labelled array).</p>
<p>Well, in the hope it makes some sense to you, let&#8217;s go on.</p>
<div class="section" id="automatic-naming">
<span id="id5"></span><h3>Automatic naming<a class="headerlink" href="#automatic-naming" title="Permalink to this headline">¶</a></h3>
<p>Note that if any of <cite>axes=</cite>, <cite>dims=</cite> or <cite>labels=</cite> is omitted, dimarray proceeds to automatic naming / labelling, using np.arange() for axis values, and &#8220;x0&#8221;, &#8220;x1&#8221; etc... for axis names:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">DimArray</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;dim1&#39;</span><span class="p">,</span><span class="s">&#39;dim1&#39;</span><span class="p">])</span> <span class="c"># axis values defined as np.arange()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">labels</span>
<span class="go">(array([0, 1]), array([0, 1, 2]))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">DimArray</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span> <span class="c"># axis values defined as np.arange()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">dims</span>
<span class="go">(&#39;x0&#39;, &#39;x1&#39;)</span>
</pre></div>
</div>
<p>As a convenience for the 1-D case when axis name is less relevant, the brackets on <cite>labels</cite> can be omitted, with or without keywords:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">DimArray</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">DimArray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">dimarray: 2 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x0&#39;</span>
<span class="go">0 / x0 (2): a to b</span>
<span class="go">array([1, 6])</span>
</pre></div>
</div>
</div>
<div class="section" id="key-word-arguments">
<span id="id6"></span><h3>Key-word arguments<a class="headerlink" href="#key-word-arguments" title="Permalink to this headline">¶</a></h3>
<p>Other convenience include the definition of da.array as alias for da.DimArray and da.array_kw as alias for DimArray.from_kw. The latter accepts axes as keyword arguments. But beware, as it cannot recover the order of axes unless it can be guessed from the array shape (i.e. all dimensions have different sizes).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">array_kw</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">],</span> <span class="n">time</span><span class="o">=</span><span class="p">[</span><span class="mi">2000</span><span class="p">,</span><span class="mi">2001</span><span class="p">,</span><span class="mi">2002</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">dimarray: 6 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;labels&#39;, &#39;time&#39;</span>
<span class="go">0 / labels (2): a to b</span>
<span class="go">1 / time (3): 2000 to 2002</span>
<span class="go">array([[1, 2, 3],</span>
<span class="go">       [4, 5, 6]])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="indexing">
<span id="id7"></span><h2>Indexing<a class="headerlink" href="#indexing" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dimarray</span> <span class="kn">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dimarray</span> <span class="kn">import</span> <span class="n">DimArray</span>
</pre></div>
</div>
<div class="section" id="basics-integer-array-slice">
<span id="id8"></span><h3>Basics: integer, array, slice<a class="headerlink" href="#basics-integer-array-slice" title="Permalink to this headline">¶</a></h3>
<p>There are various ways of indexing a DimArray, and all follow numpy&#8217;s rules, except that in the default behaviour indices refer to axis values and not to position on the axis, in contrast to numpy.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dimarray</span> <span class="kn">import</span> <span class="n">DimArray</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">DimArray</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[[</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="s">&quot;b&quot;</span><span class="p">,</span><span class="s">&quot;c&quot;</span><span class="p">,</span><span class="s">&quot;d&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.</span><span class="p">,</span><span class="mf">20.</span><span class="p">]],</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;x0&#39;</span><span class="p">,</span><span class="s">&#39;x1&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span>
<span class="go">dimarray: 8 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x0&#39;, &#39;x1&#39;</span>
<span class="go">0 / x0 (4): a to d</span>
<span class="go">1 / x1 (2): 10.0 to 20.0</span>
<span class="go">array([[ 1.,  2.],</span>
<span class="go">       [ 3.,  4.],</span>
<span class="go">       [ 5.,  6.],</span>
<span class="go">       [ 7.,  8.]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span>  <span class="c"># extract a single item</span>
<span class="go">2.0</span>
</pre></div>
</div>
<p>The <cite>ix</cite> attrubutes is the pendant for position (integer) indexing (and exclusively so !). It is therefore similar to indexing on the <cite>values</cite> attribute, except that it returns a new DimArray, where v.values[...] would return a numpy ndarray.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
<span class="go">dimarray: 2 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x1&#39;</span>
<span class="go">0 / x1 (2): 10.0 to 20.0</span>
<span class="go">array([ 1.,  2.])</span>
</pre></div>
</div>
<p>Note that the last element of slices is INCLUDED, contrary to numpy&#8217;s position indexing. Step argument is always intrepreted as an integer.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">:</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>  <span class="c"># &#39;c&#39; is INCLUDED</span>
<span class="go">dimarray: 3 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x0&#39;</span>
<span class="go">0 / x0 (3): a to c</span>
<span class="go">array([ 1.,  3.,  5.])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="p">[[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">],</span><span class="mi">10</span><span class="p">]</span>  <span class="c"># it is possible to provide a list</span>
<span class="go">dimarray: 2 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x0&#39;</span>
<span class="go">0 / x0 (2): a to c</span>
<span class="go">array([ 1.,  5.])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">x0</span> <span class="o">!=</span> <span class="s">&#39;b&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>  <span class="c"># boolean indexing is also fine</span>
<span class="go">dimarray: 3 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x0&#39;</span>
<span class="go">0 / x0 (3): a to d</span>
<span class="go">array([ 1.,  5.,  7.])</span>
</pre></div>
</div>
<p>If several array-like indices are provided, they are broadcast into a single shape (like numpy does), and values are extracted along the corresponding line.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="p">[[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">],[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">]]</span>  <span class="c"># it is possible to provide a list</span>
<span class="go">dimarray: 2 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x0,x1&#39;</span>
<span class="go">0 / x0,x1 (2): (&#39;a&#39;, &#39;10.0&#39;) to (&#39;c&#39;, &#39;20.0&#39;)</span>
<span class="go">array([ 1.,  6.])</span>
</pre></div>
</div>
<p>This is in contrast to matlab or pandas, which use box-like indexing, along each dimension independently. This can be achieved with the <cite>box</cite> attribute:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">box</span><span class="p">[[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">],[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">]]</span>  <span class="c"># indexing on each dimension, individually</span>
<span class="go">dimarray: 4 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x0&#39;, &#39;x1&#39;</span>
<span class="go">0 / x0 (2): a to c</span>
<span class="go">1 / x1 (2): 10.0 to 20.0</span>
<span class="go">array([[ 1.,  2.],</span>
<span class="go">       [ 5.,  6.]])</span>
</pre></div>
</div>
</div>
<div class="section" id="modify-array-values">
<span id="id9"></span><h3>Modify array values<a class="headerlink" href="#modify-array-values" title="Permalink to this headline">¶</a></h3>
<p>All the above can be used to change array values, consistently with what you would expect. A few examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="p">[</span><span class="s">&#39;d&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">box</span><span class="p">[[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">],[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="p">[[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">],[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span> <span class="c"># last element to 5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span>
<span class="go">dimarray: 8 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x0&#39;, &#39;x1&#39;</span>
<span class="go">0 / x0 (4): a to d</span>
<span class="go">1 / x1 (2): 10.0 to 20.0</span>
<span class="go">array([[ 4.,  3.],</span>
<span class="go">       [ 2.,  0.],</span>
<span class="go">       [ 3.,  4.],</span>
<span class="go">       [ 6.,  6.]])</span>
</pre></div>
</div>
</div>
<div class="section" id="take-and-put-methods">
<span id="id10"></span><h3>take and put methods<a class="headerlink" href="#take-and-put-methods" title="Permalink to this headline">¶</a></h3>
<p>These two methods are the machinery to accessing and modifying items in the examples above.
They may be useful to use directly for generic programming.
They are similar to numpy methods of the same name, but also work in multiple dimensions.
In particular, they both take dictionary, tuples and boolean arrays as <cite>indices</cite> argument.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">DimArray</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[[</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="s">&quot;b&quot;</span><span class="p">,</span><span class="s">&quot;c&quot;</span><span class="p">,</span><span class="s">&quot;d&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.</span><span class="p">,</span><span class="mf">20.</span><span class="p">]],</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;x0&#39;</span><span class="p">,</span><span class="s">&#39;x1&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s">&#39;x1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">take</span><span class="p">({</span><span class="s">&#39;x1&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">})</span> <span class="c"># dict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">take</span><span class="p">((</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">),</span><span class="mi">10</span><span class="p">))</span> <span class="c"># tuple</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a</span><span class="o">==</span><span class="n">b</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a</span><span class="o">==</span><span class="n">b</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a</span><span class="o">==</span><span class="n">c</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a</span><span class="o">==</span><span class="n">d</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a</span><span class="o">==</span><span class="n">e</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">dimarray: 4 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x0&#39;</span>
<span class="go">0 / x0 (4): a to d</span>
<span class="go">array([ 1.,  3.,  5.,  7.])</span>
</pre></div>
</div>
<p>The two latter forms, <cite>tuple</cite> or <cite>dict</cite>, allow performing multi-indexing. Array broadcasting is controlled by &#8220;broadcast_arrays&#8221; parameter.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">take</span><span class="p">({</span><span class="s">&#39;x0&#39;</span><span class="p">:[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">],</span> <span class="s">&#39;x1&#39;</span><span class="p">:[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]})</span>
<span class="go">dimarray: 2 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x0,x1&#39;</span>
<span class="go">0 / x0,x1 (2): (&#39;a&#39;, &#39;10.0&#39;) to (&#39;b&#39;, &#39;20.0&#39;)</span>
<span class="go">array([ 1.,  4.])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">take</span><span class="p">({</span><span class="s">&#39;x0&#39;</span><span class="p">:[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">],</span> <span class="s">&#39;x1&#39;</span><span class="p">:[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]},</span> <span class="n">broadcast_arrays</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>  <span class="c">#  same as v.box[[&#39;a&#39;,&#39;b&#39;],[10, 20]]</span>
<span class="go">dimarray: 4 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x0&#39;, &#39;x1&#39;</span>
<span class="go">0 / x0 (2): a to b</span>
<span class="go">1 / x1 (2): 10.0 to 20.0</span>
<span class="go">array([[ 1.,  2.],</span>
<span class="go">       [ 3.,  4.]])</span>
</pre></div>
</div>
<p>The &#8216;indexing&#8217; parameter can be set to <cite>position</cite> (same as <cite>ix</cite>) instead of <cite>values</cite></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s">&#39;position&#39;</span><span class="p">)</span>
<span class="go">dimarray: 4 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x0&#39;</span>
<span class="go">0 / x0 (4): a to d</span>
<span class="go">array([ 1.,  3.,  5.,  7.])</span>
</pre></div>
</div>
<p>Note the <cite>put</cite> command returns a copy by default (<cite>inplace=</cite> can be passed as True, though).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="o">-</span><span class="mi">99</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s">&#39;x1&#39;</span><span class="p">)</span>
<span class="go">dimarray: 8 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x0&#39;, &#39;x1&#39;</span>
<span class="go">0 / x0 (4): a to d</span>
<span class="go">1 / x1 (2): 10.0 to 20.0</span>
<span class="go">array([[-99.,   2.],</span>
<span class="go">       [-99.,   4.],</span>
<span class="go">       [-99.,   6.],</span>
<span class="go">       [-99.,   8.]])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="operations">
<span id="id11"></span><h2>Operations<a class="headerlink" href="#operations" title="Permalink to this headline">¶</a></h2>
<p>Most operations working in numpy should work with a DimArray, otherwise please file a bug report ! Additionally, automatic axis alignment and dimension broadcasting is performed, see [Get started](#Get-started) section.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]],</span><span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;x0&#39;</span><span class="p">,</span><span class="s">&#39;x1&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">/</span> <span class="mi">2</span>    <span class="c"># True division, returning a float in all cases</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">//</span> <span class="mi">2</span>   <span class="c"># floor division</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">*</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">**</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">+=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">+</span> <span class="n">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">-</span> <span class="n">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">/</span> <span class="n">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">//</span> <span class="n">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">*</span> <span class="n">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">**</span> <span class="n">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">==</span> <span class="n">a</span>
<span class="go">dimarray: 6 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x0&#39;, &#39;x1&#39;</span>
<span class="go">0 / x0 (2): 0 to 1</span>
<span class="go">1 / x1 (3): 0 to 2</span>
<span class="go">array([[ True,  True,  True],</span>
<span class="go">       [ True,  True,  True]], dtype=bool)</span>
</pre></div>
</div>
</div>
<div class="section" id="along-axis-transformations">
<span id="id12"></span><h2>Along-axis transformations<a class="headerlink" href="#along-axis-transformations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="just-like-numpy-use-axis-name">
<span id="id13"></span><h3>Just like numpy. Use axis name !<a class="headerlink" href="#just-like-numpy-use-axis-name" title="Permalink to this headline">¶</a></h3>
<p>Most numpy transformations are built in. Let&#8217;s create some random data to try it out:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="s">&#39;time&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span><span class="mi">1954</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat</span> <span class="o">=</span> <span class="s">&#39;lat&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">time</span><span class="p">,</span> <span class="n">lat</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span>
<span class="go">dimarray: 12 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;time&#39;, &#39;lat&#39;</span>
<span class="go">0 / time (4): 1950 to 1953</span>
<span class="go">1 / lat (3): -90.0 to 90.0</span>
<span class="go">array([[  5.,   7.,   6.],</span>
<span class="go">       [  5.,   4.,   6.],</span>
<span class="go">       [  4.,   9.,  10.],</span>
<span class="go">       [  4.,   8.,   5.]])</span>
</pre></div>
</div>
<p>In axis-reduction operations, not providing the axis results in the operation being applied to the flattened array, following numpy&#8217;s rule:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c"># sum over all axes</span>
<span class="go">73.0</span>
</pre></div>
</div>
<p>To perform the operation along an axis, it must be indicated by an integer (axis rank) or - new in dimarray - by a string (axis name):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c"># sum over first axis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">&#39;time&#39;</span><span class="p">)</span> <span class="c"># named axis</span>
<span class="go">dimarray: 3 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;lat&#39;</span>
<span class="go">0 / lat (3): -90.0 to 90.0</span>
<span class="go">array([ 18.,  28.,  27.])</span>
</pre></div>
</div>
<p>All axis-reduction transformations, following numpy:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># sum, product</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># moments</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># median, min, max, peak-to-peak</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">ptp</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># argmin, argmax: locate the minimum and maximum of an array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># determine if all or any of the elements are True (or non-zero)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In <cite>dimarray</cite>, the <cite>argmin</cite> and <cite>argmax</cite> functions return axis value instead of axis position.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
<span class="go">(1951, 0.0)</span>
</pre></div>
</div>
<p>...which is consistent with indexing on axis values:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">argmin</span><span class="p">()],</span> <span class="n">v</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="go">(4.0, 4.0)</span>
</pre></div>
</div>
<p>The along axis version works similarly:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">date_min</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">&#39;time&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">date_min</span>
<span class="go">dimarray: 3 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;lat&#39;</span>
<span class="go">0 / lat (3): -90.0 to 90.0</span>
<span class="go">array([1952, 1951, 1953])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="p">[</span><span class="n">date_min</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">lat</span><span class="p">]</span>  <span class="c"># this makes use of array-broadcasting when indexing with two arrays</span>
<span class="go">dimarray: 3 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;time,lat&#39;</span>
<span class="go">0 / time,lat (3): (1952.0, -90.0) to (1953.0, 90.0)</span>
<span class="go">array([ 4.,  4.,  5.])</span>
</pre></div>
</div>
<p>Operations that accumulate along an axis are also implemented, by default along the last axis, consistently with numpy. Let&#8217;s use a simpler 1-D example here.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">time</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span>
<span class="go">dimarray: 4 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;time&#39;</span>
<span class="go">0 / time (4): 1950 to 1953</span>
<span class="go">array([ 1.,  2.,  3.,  4.])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">cumprod</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="go">dimarray: 4 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;time&#39;</span>
<span class="go">0 / time (4): 1950 to 1953</span>
<span class="go">array([  1.,   3.,   6.,  10.])</span>
</pre></div>
</div>
<p>A new <cite>diff</cite> method comes with <cite>dimarray</cite>, which reduces axis size by one, by default (and by default <cite>diff</cite> operates along the last axis, like <cite>cumsum</cite>).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="go">dimarray: 3 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;time&#39;</span>
<span class="go">0 / time (3): 1951 to 1953</span>
<span class="go">array([ 2.,  3.,  4.])</span>
</pre></div>
</div>
<p>The <cite>keepaxis=</cite> parameter fills array with <cite>nan</cite> where necessary to keep the axis unchanged. Default is backward differencing: <cite>diff[i] = v[i] - v[i-1]</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">keepaxis</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">dimarray: 3 non-null elements (1 null)</span>
<span class="go">dimensions: &#39;time&#39;</span>
<span class="go">0 / time (4): 1950 to 1953</span>
<span class="go">array([ nan,   2.,   3.,   4.])</span>
</pre></div>
</div>
<p>But other schemes are available to control how the new axis is defined: <cite>backward</cite> (default), <cite>forward</cite> and even <cite>centered</cite></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">keepaxis</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s">&quot;forward&quot;</span><span class="p">)</span> <span class="c"># diff[i] = v[i+1] - v[i]</span>
<span class="go">dimarray: 3 non-null elements (1 null)</span>
<span class="go">dimensions: &#39;time&#39;</span>
<span class="go">0 / time (4): 1950 to 1953</span>
<span class="go">array([  2.,   3.,   4.,  nan])</span>
</pre></div>
</div>
<p>The <cite>keepaxis=True</cite> option is invalid with the <cite>centered</cite> scheme, since every axis value is modified by definition:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">&#39;time&#39;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s">&#39;centered&#39;</span><span class="p">)</span>
<span class="go">dimarray: 3 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;time&#39;</span>
<span class="go">0 / time (3): 1950.5 to 1952.5</span>
<span class="go">array([ 2.,  3.,  4.])</span>
</pre></div>
</div>
</div>
<div class="section" id="missing-values">
<span id="id14"></span><h3>Missing values<a class="headerlink" href="#missing-values" title="Permalink to this headline">¶</a></h3>
<p><cite>dimarray</cite> treats <cite>nan</cite> as missing values, which can be skipped in transformations by passing skipna=True. Note that <cite>nan</cite> is has a <cite>float</cite> type so it cannot be assigned to an integer array.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dimarray</span> <span class="kn">as</span> <span class="nn">da</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">dimarray: 5 non-null elements (1 null)</span>
<span class="go">dimensions: &#39;x0&#39;, &#39;x1&#39;</span>
<span class="go">0 / x0 (2): 0 to 1</span>
<span class="go">1 / x1 (3): 0 to 2</span>
<span class="go">array([[  1.,   2.,   3.],</span>
<span class="go">       [  4.,   5.,  nan]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">dimarray: 2 non-null elements (1 null)</span>
<span class="go">dimensions: &#39;x1&#39;</span>
<span class="go">0 / x1 (3): 0 to 2</span>
<span class="go">array([ 2.5,  3.5,  nan])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">dimarray: 3 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x1&#39;</span>
<span class="go">0 / x1 (3): 0 to 2</span>
<span class="go">array([ 2.5,  3.5,  3. ])</span>
</pre></div>
</div>
<p>A few other methods exist but are experimental. They are mere aliases for classical <cite>a[np.isnan[a]] = value</cite> syntax, but automatically coerce integer type to float, and perform a copy by default. This could also be useful in the future to define a missing value flag other than <cite>nan</cite>, for example when working with integer array.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="go">dimarray: 6 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x0&#39;, &#39;x1&#39;</span>
<span class="go">0 / x0 (2): 0 to 1</span>
<span class="go">1 / x1 (3): 0 to 2</span>
<span class="go">array([[  1.,   2.,   3.],</span>
<span class="go">       [  4.,   5.,  99.]])</span>
</pre></div>
</div>
<p><cite>setna</cite> can also be provided with a list of values (or boolean arrays) to set to nan:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">setna</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">dimarray: 3 non-null elements (3 null)</span>
<span class="go">dimensions: &#39;x0&#39;, &#39;x1&#39;</span>
<span class="go">0 / x0 (2): 0 to 1</span>
<span class="go">1 / x1 (3): 0 to 2</span>
<span class="go">array([[ nan,   2.,   3.],</span>
<span class="go">       [ nan,   5.,  nan]])</span>
</pre></div>
</div>
<p>More interestingly, the <cite>dropna</cite> methods helps getting rid of nans arising in grouping operations, similarly to <cite>pandas</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">dimarray: 2 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x0&#39;, &#39;x1&#39;</span>
<span class="go">0 / x0 (2): 0 to 1</span>
<span class="go">1 / x1 (1): 1 to 1</span>
<span class="go">array([[ 2.],</span>
<span class="go">       [ 5.]])</span>
</pre></div>
</div>
<p>But in some cases, you are still ok with a certain number of nans, but want to have a minimum of 1 or more valid values:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">minvalid</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c"># minimum number of valid values, equivalent to `how=&quot;all&quot;` in pandas</span>
<span class="go">dimarray: 3 non-null elements (1 null)</span>
<span class="go">dimensions: &#39;x0&#39;, &#39;x1&#39;</span>
<span class="go">0 / x0 (2): 0 to 1</span>
<span class="go">1 / x1 (2): 1 to 2</span>
<span class="go">array([[  2.,   3.],</span>
<span class="go">       [  5.,  nan]])</span>
</pre></div>
</div>
</div>
<div class="section" id="weighted-mean-experimental">
<span id="id15"></span><h3>Weighted mean [experimental]<a class="headerlink" href="#weighted-mean-experimental" title="Permalink to this headline">¶</a></h3>
<p>Each axis can have a <cite>weights</cite> attribute. If not None, it will be automatically used when computing mean, var, std</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">dimarray: 5 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x0&#39;</span>
<span class="go">0 / x0 (5): 0 to 4</span>
<span class="go">array([0, 1, 2, 3, 4])</span>
</pre></div>
</div>
<p>The mean as you&#8217;d expect:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c">#  standard mean</span>
<span class="go">2.0</span>
</pre></div>
</div>
<p>Now adding the weight parameter:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">3.0</span>
</pre></div>
</div>
<p>Note it is preserved via indexing</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weights</span>
<span class="go">array([0, 1, 0])</span>
</pre></div>
</div>
<p>Also possible as a function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">3.3333333333333335</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="modify-array-shape">
<span id="id16"></span><h2>Modify array shape<a class="headerlink" href="#modify-array-shape" title="Permalink to this headline">¶</a></h2>
<p>Basic numpy methods to modify array dimensions are implemented in dimarray, with some additional functionality allowed by named dimensions.</p>
<p><strong>Methods overview</strong>: <cite>newaxis</cite>, <cite>squeeze</cite>, <cite>transpose</cite>, <cite>swapaxes</cite>, <cite>flatten</cite>, <cite>group</cite>, <cite>ungroup</cite>, <cite>reshape</cite></p>
<div class="section" id="transpose">
<span id="id17"></span><h3>transpose<a class="headerlink" href="#transpose" title="Permalink to this headline">¶</a></h3>
<p>Transpose, just like its numpy equivalent, permutes dimensions, but in dimarray it can be provided with axis names instead of just axis position.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">DimArray</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]],</span><span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;x0&#39;</span><span class="p">,</span><span class="s">&#39;x1&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">T</span>
<span class="go">dimarray: 6 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x1&#39;, &#39;x0&#39;</span>
<span class="go">0 / x1 (3): 0 to 2</span>
<span class="go">1 / x0 (2): 0 to 1</span>
<span class="go">array([[1, 3],</span>
<span class="go">       [2, 4],</span>
<span class="go">       [3, 5]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">DimArray</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]]],</span><span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;x2&#39;</span><span class="p">,</span><span class="s">&#39;x0&#39;</span><span class="p">,</span><span class="s">&#39;x1&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="s">&#39;x1&#39;</span><span class="p">,</span><span class="s">&#39;x2&#39;</span><span class="p">,</span><span class="s">&#39;x0&#39;</span><span class="p">)</span>
<span class="go">dimarray: 6 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x1&#39;, &#39;x2&#39;, &#39;x0&#39;</span>
<span class="go">0 / x1 (3): 0 to 2</span>
<span class="go">1 / x2 (1): 0 to 0</span>
<span class="go">2 / x0 (2): 0 to 1</span>
<span class="go">array([[[1, 3]],</span>
</pre></div>
</div>
<blockquote>
<div><p>[[2, 4]],</p>
<p>[[3, 5]]])</p>
</div></blockquote>
</div>
<div class="section" id="swapaxes">
<span id="id18"></span><h3>swapaxes<a class="headerlink" href="#swapaxes" title="Permalink to this headline">¶</a></h3>
<p>Sometimes it is only useful to have on dimension in the first position, for example to make indexing easier.
<cite>swapaxes</cite> is a more general method of swapping two axes, but it can achieve that operation nicely (more useful with more than 2 dimensions!):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">DimArray</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]],</span><span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;x0&#39;</span><span class="p">,</span><span class="s">&#39;x1&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="s">&#39;x1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">dimarray: 6 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;x1&#39;, &#39;x0&#39;</span>
<span class="go">0 / x1 (3): 0 to 2</span>
<span class="go">1 / x0 (2): 0 to 1</span>
<span class="go">array([[1, 3],</span>
<span class="go">       [2, 4],</span>
<span class="go">       [3, 5]])</span>
</pre></div>
</div>
</div>
<div class="section" id="group-and-ungroup-experimental">
<span id="id19"></span><h3>group and ungroup [experimental]<a class="headerlink" href="#group-and-ungroup-experimental" title="Permalink to this headline">¶</a></h3>
<p>As a new, experimental feature, it is possible to flatten (group) or any subset of dimensions. Corresponding axes are converted in GroupedAxis objects.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">array_kw</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">time</span><span class="o">=</span><span class="p">[</span><span class="mi">1950</span><span class="p">,</span><span class="mi">1955</span><span class="p">],</span> <span class="n">lat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">lon</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span>
<span class="go">dimarray: 24 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;</span>
<span class="go">0 / time (2): 1950 to 1955</span>
<span class="go">1 / lat (3): -90.0 to 90.0</span>
<span class="go">2 / lon (4): -180.0 to 180.0</span>
<span class="go">array([[[ 0,  1,  2,  3],</span>
<span class="go">        [ 4,  5,  6,  7],</span>
<span class="go">        [ 8,  9, 10, 11]],</span>
</pre></div>
</div>
<blockquote>
<div><dl class="docutils">
<dt>[[12, 13, 14, 15],</dt>
<dd>[16, 17, 18, 19],
[20, 21, 22, 23]]])</dd>
</dl>
</div></blockquote>
<p>Flatten a set of dimensions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">group</span><span class="p">((</span><span class="s">&#39;lat&#39;</span><span class="p">,</span><span class="s">&#39;lon&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span>
<span class="go">dimarray: 24 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;time&#39;, &#39;lat,lon&#39;</span>
<span class="go">0 / time (2): 1950 to 1955</span>
<span class="go">1 / lat,lon (12): (-90.0, -180.0) to (90.0, 180.0)</span>
<span class="go">array([[ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11],</span>
<span class="go">       [12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]])</span>
</pre></div>
</div>
<p>Along-axis transformations use that feature and can group any subset of axes prior to the operation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;lat&#39;</span><span class="p">,</span><span class="s">&#39;lon&#39;</span><span class="p">))</span>
<span class="go">dimarray: 2 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;time&#39;</span>
<span class="go">0 / time (2): 1950 to 1955</span>
<span class="go">array([  5.5,  17.5])</span>
</pre></div>
</div>
<p>Any grouped axis can be reshaped back to full n-d array via <strong>`ungroup`</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">ungroup</span><span class="p">()</span>
<span class="go">dimarray: 24 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;</span>
<span class="go">0 / time (2): 1950 to 1955</span>
<span class="go">1 / lat (3): -90.0 to 90.0</span>
<span class="go">2 / lon (4): -180.0 to 180.0</span>
<span class="go">array([[[ 0,  1,  2,  3],</span>
<span class="go">        [ 4,  5,  6,  7],</span>
<span class="go">        [ 8,  9, 10, 11]],</span>
</pre></div>
</div>
<blockquote>
<div><dl class="docutils">
<dt>[[12, 13, 14, 15],</dt>
<dd>[16, 17, 18, 19],
[20, 21, 22, 23]]])</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="reshape-experimental">
<span id="id20"></span><h3>reshape [experimental]<a class="headerlink" href="#reshape-experimental" title="Permalink to this headline">¶</a></h3>
<p><cite>reshape</cite> is similar but not the same as numpy ndarray&#8217;s <cite>reshape</cite>. It takes only axis names as parameters. It is a high-level function that combine <cite>newaxis</cite>, <cite>squeeze</cite>, <cite>group</cite> and <cite>ungroup</cite> to reshape the array. It differs from numpy in that it cannot &#8220;break&#8221; an existing dimension (unless it is a GroupedAxis). Provided with the parameter <cite>transpose=True</cite>, it also performs transpose as needed to match the required shape.</p>
<p>Here an example where high-dimensional data is converted into a pandas&#8217; DataFrame for displaying result of a sensitivity analysis. GroupedAxis are converted into MultiIndex before passing to pandas.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">large_array</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span><span class="s">&#39;B&#39;</span><span class="p">,</span><span class="s">&#39;C&#39;</span><span class="p">,</span><span class="s">&#39;D&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">large_array</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="s">&#39;A,B&#39;</span><span class="p">,</span><span class="s">&#39;C,D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="go">C     0       1       2       3       4</span>
<span class="go">D     0   1   0   1   0   1   0   1   0   1</span>
<span class="go">A B</span>
<span class="go">0 0   0   1   2   3   4   5   6   7   8   9</span>
<span class="go">  1  10  11  12  13  14  15  16  17  18  19</span>
<span class="go">1 0  20  21  22  23  24  25  26  27  28  29</span>
<span class="go">  1  30  31  32  33  34  35  36  37  38  39</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="broadcast-dimensions">
<span id="id21"></span><h2>broadcast dimensions<a class="headerlink" href="#broadcast-dimensions" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s play with dimensions, by considering the three dimensions below:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span><span class="mi">1955</span><span class="p">)</span>
</pre></div>
</div>
<p>we can define a timeseries and a time-varying map</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">timeseries</span> <span class="o">=</span> <span class="n">DimArray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[(</span><span class="s">&#39;time&#39;</span><span class="p">,</span><span class="n">time</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timeseries</span>
<span class="go">dimarray: 5 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;time&#39;</span>
<span class="go">0 / time (5): 1950 to 1954</span>
<span class="go">array([1, 2, 3, 4, 5])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cube</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">zeros</span><span class="p">([(</span><span class="s">&#39;lon&#39;</span><span class="p">,</span> <span class="n">lon</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;lat&#39;</span><span class="p">,</span><span class="n">lat</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;time&#39;</span><span class="p">,</span><span class="n">time</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cube</span>  
<span class="go">dimarray: 30 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;lon&#39;, &#39;lat&#39;, &#39;time&#39;</span>
<span class="go">0 / lon (2): 10.0 to 30.0</span>
<span class="go">1 / lat (3): 10.0 to 50.0</span>
<span class="go">2 / time (5): 1950 to 1954</span>
<span class="go">array([[[ 0.,  0.,  0.,  0.,  0.],</span>
<span class="go">        [ 0.,  0.,  0.,  0.,  0.],</span>
<span class="go">        [ 0.,  0.,  0.,  0.,  0.]],</span>
</pre></div>
</div>
<blockquote>
<div><dl class="docutils">
<dt>[[ 0.,  0.,  0.,  0.,  0.],</dt>
<dd>[ 0.,  0.,  0.,  0.,  0.],
[ 0.,  0.,  0.,  0.,  0.]]])</dd>
</dl>
</div></blockquote>
<p>Suppose we want to repeat the timeseries so that it matches <cite>cube</cite> dimension. <strong>`newaxis`</strong> is a handy method for that. Starting with lon:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">timeseries</span><span class="o">.</span><span class="n">newaxis</span><span class="p">(</span><span class="s">&#39;lon&#39;</span><span class="p">,</span> <span class="n">cube</span><span class="o">.</span><span class="n">lon</span><span class="p">)</span>
<span class="go">dimarray: 10 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;lon&#39;, &#39;time&#39;</span>
<span class="go">0 / lon (2): 10.0 to 30.0</span>
<span class="go">1 / time (5): 1950 to 1954</span>
<span class="go">array([[1, 2, 3, 4, 5],</span>
<span class="go">       [1, 2, 3, 4, 5]])</span>
</pre></div>
</div>
<p>And then one could add the remaining dimension. A more automatic way of doing the same thing is via the <cite>broadcast</cite>, method, which could also have been called <cite>broadcast_like</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">timeseries</span><span class="o">.</span><span class="n">broadcast</span><span class="p">(</span><span class="n">cube</span><span class="p">)</span>
<span class="go">dimarray: 30 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;lon&#39;, &#39;lat&#39;, &#39;time&#39;</span>
<span class="go">0 / lon (2): 10.0 to 30.0</span>
<span class="go">1 / lat (3): 10.0 to 50.0</span>
<span class="go">2 / time (5): 1950 to 1954</span>
<span class="go">array([[[1, 2, 3, 4, 5],</span>
<span class="go">        [1, 2, 3, 4, 5],</span>
<span class="go">        [1, 2, 3, 4, 5]],</span>
</pre></div>
</div>
<blockquote>
<div><dl class="docutils">
<dt>[[1, 2, 3, 4, 5],</dt>
<dd>[1, 2, 3, 4, 5],
[1, 2, 3, 4, 5]]])</dd>
</dl>
</div></blockquote>
<p>It is also possible to proceed to broadcasting on a sequence of arrays, via <cite>broadcast_arrays</cite> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;x0&#39;</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;x1&#39;</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">broadcast_arrays</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">[dimarray: 6 non-null elements (0 null)</span>
<span class="go"> dimensions: &#39;x0&#39;, &#39;x1&#39;</span>
<span class="go"> 0 / x0 (2): 0 to 1</span>
<span class="go"> 1 / x1 (3): 0 to 2</span>
<span class="go"> array([[0, 0, 0],</span>
<span class="go">        [1, 1, 1]]), dimarray: 6 non-null elements (0 null)</span>
<span class="go"> dimensions: &#39;x0&#39;, &#39;x1&#39;</span>
<span class="go"> 0 / x0 (2): 0 to 1</span>
<span class="go"> 1 / x1 (3): 0 to 2</span>
<span class="go"> array([[0, 1, 2],</span>
<span class="go">        [0, 1, 2]])]</span>
</pre></div>
</div>
<p>But as we will see in the next sections, you will not have to use these methods very often since broadcasting is done automatically when performing operations.</p>
</div>
<div class="section" id="reindexing-align-axes">
<span id="id22"></span><h2>Reindexing: align axes<a class="headerlink" href="#reindexing-align-axes" title="Permalink to this headline">¶</a></h2>
<p>Reindexing is the action of shrinking or extending an array to match a new index, in some ways similar to interpolation, except that by default, the new index has to be present, or it is filled with NaN. Actual interpolation is performed by passing <cite>method=&#8221;nearest&#8221;</cite> or <cite>method=&#8221;interp&#8221;</cite> parameter.</p>
<div class="section" id="reindex-axis">
<span id="id23"></span><h3>reindex_axis<a class="headerlink" href="#reindex-axis" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[(</span><span class="s">&#39;x0&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">reindex_axis</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">dimarray: 2 non-null elements (1 null)</span>
<span class="go">dimensions: &#39;x0&#39;</span>
<span class="go">0 / x0 (3): 1 to 3</span>
<span class="go">array([  3.,  nan,   4.])</span>
</pre></div>
</div>
<p>Also works with string indices</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[(</span><span class="s">&#39;x0&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">reindex_axis</span><span class="p">([</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">])</span>
<span class="go">dimarray: 1 non-null elements (1 null)</span>
<span class="go">dimensions: &#39;x0&#39;</span>
<span class="go">0 / x0 (2): b to d</span>
<span class="go">array([  2.,  nan])</span>
</pre></div>
</div>
</div>
<div class="section" id="reindex-like">
<span id="id24"></span><h3>reindex_like<a class="headerlink" href="#reindex-like" title="Permalink to this headline">¶</a></h3>
<p>Same as reindex_axis, except that the new axes are searched for in another array.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]],[(</span><span class="s">&#39;x0&#39;</span><span class="p">,[</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="s">&quot;b&quot;</span><span class="p">]),(</span><span class="s">&#39;x1&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">reindex_like</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">dimarray: 6 non-null elements (3 null)</span>
<span class="go">dimensions: &#39;x0&#39;, &#39;x1&#39;</span>
<span class="go">0 / x0 (3): a to c</span>
<span class="go">1 / x1 (3): 1 to 3</span>
<span class="go">array([[  1.,   2.,   3.],</span>
<span class="go">       [  4.,   5.,   6.],</span>
<span class="go">       [ nan,  nan,  nan]])</span>
</pre></div>
</div>
</div>
<div class="section" id="interpolation">
<span id="id25"></span><h3>Interpolation<a class="headerlink" href="#interpolation" title="Permalink to this headline">¶</a></h3>
<p>The <cite>method=</cite> parameter can be passed to <cite>reindex_axis</cite> and <cite>reindex_like</cite> with values &#8220;nearest&#8221; and &#8220;interp&#8221; to proceed to nearest and linear interpolation.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Can also reindex in &quot;interp&quot; mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">reindex_axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;interp&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#c.reindex_like(b, method=&#39;interp&#39;)</span>
<span class="go">dimarray: 3 non-null elements (1 null)</span>
<span class="go">dimensions: &#39;x0&#39;</span>
<span class="go">0 / x0 (4): 0 to 3</span>
<span class="go">array([ nan,  3. ,  3.5,  4. ])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dimarray</span> <span class="kn">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span><span class="mi">1955</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">array_kw</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">time</span><span class="p">),</span> <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">reindex_axis</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1948</span><span class="p">,</span><span class="mi">1957</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="s">&#39;time&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;interp&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">reindex_axis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1948</span><span class="p">,</span><span class="mi">1957</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="s">&#39;time&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;nearest&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s">&#39;s-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;original&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">w</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s">&#39;o-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;interp&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#plt.plot(w1.time, w.values, &#39;o--&#39;, color=&#39;k&#39;, label=&#39;interp&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s">&#39;*-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;nearest&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;upper left&#39;</span><span class="p">)</span>
<span class="go">&lt;matplotlib.legend.Legend at 0x7f5542f88f90&gt;&lt;matplotlib.figure.Figure at 0x7f5547c90790&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="align-axes">
<span id="id26"></span><h3>align_axes<a class="headerlink" href="#align-axes" title="Permalink to this headline">¶</a></h3>
<p>It is also possible to proceed to axis alignment on a sequence of arrays (not in interpolation mode!):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># align axes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],(</span><span class="s">&#39;x0&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],(</span><span class="s">&#39;x0&#39;</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">align_axes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">[dimarray: 3 non-null elements (1 null)</span>
<span class="go"> dimensions: &#39;x0&#39;</span>
<span class="go"> 0 / x0 (4): 1 to 4</span>
<span class="go"> array([  1.,   2.,   3.,  nan]), dimarray: 2 non-null elements (2 null)</span>
<span class="go"> dimensions: &#39;x0&#39;</span>
<span class="go"> 0 / x0 (4): 1 to 4</span>
<span class="go"> array([ nan,   3.,  nan,   4.])]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="stack-and-concatenate-arrays">
<span id="id27"></span><h2>Stack and concatenate arrays<a class="headerlink" href="#stack-and-concatenate-arrays" title="Permalink to this headline">¶</a></h2>
<div class="section" id="concatenate-arrays-along-existing-axis">
<span id="id28"></span><h3>concatenate arrays along existing axis<a class="headerlink" href="#concatenate-arrays-along-existing-axis" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]],</span><span class="n">axes</span><span class="o">=</span><span class="p">[(</span><span class="s">&#39;line&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="s">&#39;col&#39;</span><span class="p">,[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]],</span> <span class="n">axes</span><span class="o">=</span><span class="p">[(</span><span class="s">&#39;line&#39;</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="s">&#39;col&#39;</span><span class="p">,[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">dimarray: 9 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;line&#39;, &#39;col&#39;</span>
<span class="go">0 / line (3): 1 to 3</span>
<span class="go">1 / col (3): a to c</span>
<span class="go">array([[ 1.,  2.,  3.],</span>
<span class="go">       [ 4.,  5.,  6.],</span>
<span class="go">       [ 7.,  8.,  9.]])</span>
</pre></div>
</div>
</div>
<div class="section" id="stack-arrays-along-new-axis">
<span id="id29"></span><h3>stack arrays along new axis<a class="headerlink" href="#stack-arrays-along-new-axis" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">stack</span><span class="p">({</span><span class="s">&#39;a&#39;</span><span class="p">:</span><span class="n">a</span><span class="p">,</span> <span class="s">&#39;2*a&#39;</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s">&#39;items&#39;</span><span class="p">)</span>   <span class="c"># dictionary</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">],</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;2*a&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s">&#39;items&#39;</span><span class="p">)</span>  <span class="c"># list</span>
<span class="go">dimarray: 6 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;items&#39;, &#39;x0&#39;</span>
<span class="go">0 / items (2): a to 2*a</span>
<span class="go">1 / x0 (3): 0 to 2</span>
<span class="go">array([[10, 20, 30],</span>
<span class="go">       [20, 40, 60]])</span>
</pre></div>
</div>
<p>with axis alignment</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">],</span> <span class="p">(</span><span class="s">&#39;x0&#39;</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">(</span><span class="s">&#39;x0&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">],</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">],</span> <span class="n">align</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">dimarray: 6 non-null elements (2 null)</span>
<span class="go">dimensions: &#39;unnamed&#39;, &#39;x0&#39;</span>
<span class="go">0 / unnamed (2): a to b</span>
<span class="go">1 / x0 (4): 0 to 3</span>
<span class="go">array([[ 10.,  20.,  30.,  nan],</span>
<span class="go">       [ nan,   1.,   2.,   3.]])</span>
</pre></div>
</div>
</div>
<div class="section" id="broadcast-and-stack-arrays">
<span id="id30"></span><h3>broadcast and stack arrays<a class="headerlink" href="#broadcast-and-stack-arrays" title="Permalink to this headline">¶</a></h3>
<p>If the arrays to join also need to be broadcast prior concatenation, da.array comes in handy</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">],</span> <span class="p">(</span><span class="s">&#39;x0&#39;</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">(</span><span class="s">&#39;x1&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">c</span><span class="p">],</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">])</span>
<span class="go">dimarray: 18 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;unnamed&#39;, &#39;x0&#39;, &#39;x1&#39;</span>
<span class="go">0 / unnamed (2): a to c</span>
<span class="go">1 / x0 (3): 0 to 2</span>
<span class="go">2 / x1 (3): 1 to 3</span>
<span class="go">array([[[10, 10, 10],</span>
<span class="go">        [20, 20, 20],</span>
<span class="go">        [30, 30, 30]],</span>
</pre></div>
</div>
<blockquote>
<div><dl class="docutils">
<dt>[[ 1,  2,  3],</dt>
<dd>[ 1,  2,  3],
[ 1,  2,  3]]])</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="aggregate-arrays-of-varying-dimensions-experimental">
<span id="id31"></span><h3>aggregate arrays of varying dimensions [Experimental]<a class="headerlink" href="#aggregate-arrays-of-varying-dimensions-experimental" title="Permalink to this headline">¶</a></h3>
<p>Here a nice example of puzzle filling (values in the output array indicate the order of insertion):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]],</span><span class="n">axes</span><span class="o">=</span><span class="p">[(</span><span class="s">&#39;line&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="s">&#39;col&#39;</span><span class="p">,[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">]],</span> <span class="n">axes</span><span class="o">=</span><span class="p">[(</span><span class="s">&#39;line&#39;</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="s">&#39;col&#39;</span><span class="p">,[</span><span class="s">&#39;d&#39;</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([[</span><span class="mi">6</span><span class="p">]],</span> <span class="n">axes</span><span class="o">=</span><span class="p">[(</span><span class="s">&#39;line&#39;</span><span class="p">,[</span><span class="mi">2</span><span class="p">]),</span> <span class="p">(</span><span class="s">&#39;col&#39;</span><span class="p">,[</span><span class="s">&#39;b&#39;</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([</span><span class="o">-</span><span class="mi">7</span><span class="p">],</span> <span class="n">axes</span><span class="o">=</span><span class="p">[(</span><span class="s">&#39;line&#39;</span><span class="p">,[</span><span class="mi">4</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">aggregate</span><span class="p">((</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">))</span>
<span class="go">dimarray: 10 non-null elements (6 null)</span>
<span class="go">dimensions: &#39;line&#39;, &#39;col&#39;</span>
<span class="go">0 / line (4): 1 to 4</span>
<span class="go">1 / col (4): a to d</span>
<span class="go">array([[  1.,   2.,   3.,  nan],</span>
<span class="go">       [ nan,   6.,  nan,   4.],</span>
<span class="go">       [ nan,  nan,  nan,   5.],</span>
<span class="go">       [ -7.,  -7.,  -7.,  -7.]])</span>
</pre></div>
</div>
<p>Risk of overlapping checked. In case of overlapping of a valid and an invalid value, keep the valid one</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]],</span><span class="n">axes</span><span class="o">=</span><span class="p">[(</span><span class="s">&#39;line&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="s">&#39;col&#39;</span><span class="p">,[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],[</span><span class="mi">5</span><span class="p">]],</span> <span class="n">axes</span><span class="o">=</span><span class="p">[(</span><span class="s">&#39;line&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="p">(</span><span class="s">&#39;col&#39;</span><span class="p">,[</span><span class="s">&#39;b&#39;</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">aggregate</span><span class="p">((</span><span class="n">a</span><span class="p">,</span><span class="n">e</span><span class="p">))</span> <span class="c"># does not overwrite `2` at location (1, &#39;b&#39;)</span>
<span class="go">dimarray: 4 non-null elements (2 null)</span>
<span class="go">dimensions: &#39;line&#39;, &#39;col&#39;</span>
<span class="go">0 / line (2): 1 to 2</span>
<span class="go">1 / col (3): a to c</span>
<span class="go">array([[  1.,   2.,   3.],</span>
<span class="go">       [ nan,   5.,  nan]])</span>
</pre></div>
</div>
<p>But any loss of data (overlap between two valid values) is prevented by raising an exception:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]],</span><span class="n">axes</span><span class="o">=</span><span class="p">[(</span><span class="s">&#39;line&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="s">&#39;col&#39;</span><span class="p">,[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">DimArray</span><span class="p">([[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">]],</span> <span class="n">axes</span><span class="o">=</span><span class="p">[(</span><span class="s">&#39;line&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="p">(</span><span class="s">&#39;col&#39;</span><span class="p">,[</span><span class="s">&#39;b&#39;</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">da</span><span class="o">.</span><span class="n">aggregate</span><span class="p">((</span><span class="n">a</span><span class="p">,</span><span class="n">e</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">print</span> <span class="n">msg</span>
<span class="go">Overlapping arrays: set check_overlap to False to suppress this error.</span>
</pre></div>
</div>
<p>Unless specified otherwise with <cite>check_overlap=False</cite> (will also speedup the operation)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">aggregate</span><span class="p">((</span><span class="n">a</span><span class="p">,</span><span class="n">e</span><span class="p">),</span> <span class="n">check_overlap</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">dimarray: 4 non-null elements (2 null)</span>
<span class="go">dimensions: &#39;line&#39;, &#39;col&#39;</span>
<span class="go">0 / line (2): 1 to 2</span>
<span class="go">1 / col (3): a to c</span>
<span class="go">array([[  1.,   4.,   3.],</span>
<span class="go">       [ nan,   5.,  nan]])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="dataset">
<span id="id32"></span><h2>Dataset<a class="headerlink" href="#dataset" title="Permalink to this headline">¶</a></h2>
<p>A dataset is an ordered dictionary of DimArray objects</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="s">&quot;time&quot;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span><span class="mi">1952</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat</span> <span class="o">=</span> <span class="s">&quot;lat&quot;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s">&#39;timeseries&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">time</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s">&#39;greenland&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">[</span><span class="n">time</span><span class="p">,</span> <span class="n">lat</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s">&#39;antarctica&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;greenland&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>
<span class="go">Dataset of 3 variables</span>
<span class="go">dimensions: &#39;time&#39;, &#39;lat&#39;</span>
<span class="go">0 / time (2): 1950 to 1951</span>
<span class="go">1 / lat (3): -90.0 to 90.0</span>
<span class="go">timeseries: (&#39;time&#39;,)</span>
<span class="go">greenland: (&#39;time&#39;, &#39;lat&#39;)</span>
<span class="go">antarctica: (&#39;time&#39;, &#39;lat&#39;)</span>
</pre></div>
</div>
<p>Which can be exported to a Dimarray, along the default axis <cite>items</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">dimarray: 18 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;unnamed&#39;, &#39;time&#39;, &#39;lat&#39;</span>
<span class="go">0 / unnamed (3): timeseries to antarctica</span>
<span class="go">1 / time (2): 1950 to 1951</span>
<span class="go">2 / lat (3): -90.0 to 90.0</span>
<span class="go">array([[[ 0,  0,  0],</span>
<span class="go">        [ 1,  1,  1]],</span>
</pre></div>
</div>
<blockquote>
<div><dl class="docutils">
<dt>[[ 0,  1,  2],</dt>
<dd>[ 3,  4,  5]],</dd>
<dt>[[ 0,  2,  4],</dt>
<dd>[ 6,  8, 10]]])</dd>
</dl>
</div></blockquote>
<p>Note that the timeseries dimension has been broadcast to the same shape as others (by repeating its values along the <cite>lat</cite> axis):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="s">&#39;timeseries&#39;</span><span class="p">]</span>
<span class="go">dimarray: 6 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;time&#39;, &#39;lat&#39;</span>
<span class="go">0 / time (2): 1950 to 1951</span>
<span class="go">1 / lat (3): -90.0 to 90.0</span>
<span class="go">array([[0, 0, 0],</span>
<span class="go">       [1, 1, 1]])</span>
</pre></div>
</div>
</div>
<div class="section" id="netcdf-i-o">
<span id="id33"></span><h2>NetCDF I/O<a class="headerlink" href="#netcdf-i-o" title="Permalink to this headline">¶</a></h2>
<p>A dataset is the natural object for I/O into the netCDF format:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">write_nc</span><span class="p">(</span><span class="s">&#39;test.nc&#39;</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Reading the data back is easy:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">read_nc</span><span class="p">(</span><span class="s">&#39;test.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span>
<span class="go">read from test.nc</span>
<span class="go">Dataset of 3 variables</span>
<span class="go">dimensions: &#39;time&#39;, &#39;lat&#39;</span>
<span class="go">0 / time (2): 1950 to 1951</span>
<span class="go">1 / lat (3): -90.0 to 90.0</span>
<span class="go">antarctica: (&#39;time&#39;, &#39;lat&#39;)</span>
<span class="go">greenland: (&#39;time&#39;, &#39;lat&#39;)</span>
<span class="go">timeseries: (&#39;time&#39;,)</span>
</pre></div>
</div>
<p>Single variables can be read as well:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">read_nc</span><span class="p">(</span><span class="s">&#39;test.nc&#39;</span><span class="p">,</span><span class="s">&#39;greenland&#39;</span><span class="p">)</span>
<span class="go">dimarray: 6 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;time&#39;, &#39;lat&#39;</span>
<span class="go">0 / time (2): 1950 to 1951</span>
<span class="go">1 / lat (3): -90.0 to 90.0</span>
<span class="go">array([[0, 1, 2],</span>
<span class="go">       [3, 4, 5]])</span>
</pre></div>
</div>
<p>Or even portions of a variable (that&#8217;s what makes netCDF useful compared to just HDF I/O), especially for very large datasets.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">read_nc</span><span class="p">(</span><span class="s">&#39;test.nc&#39;</span><span class="p">,</span><span class="s">&#39;greenland&#39;</span><span class="p">,</span> <span class="mi">1951</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s">&#39;time&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">dimarray: 3 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;lat&#39;</span>
<span class="go">0 / lat (3): -90.0 to 90.0</span>
<span class="go">array([3, 4, 5])</span>
</pre></div>
</div>
<p>Note that read_nc follows the same rules as <cite>take</cite>, except that multi-index arrays apply for each dimension individually (broadcast_array=False), reflecting netCDF design and underlying netCDF4 module.
It is also possible to write a single array, by indicating its name (unless it has a <cite>name</cite> attribute different from None). Note the default mode is to append a variable to existing dataset.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">write_nc</span><span class="p">(</span><span class="s">&#39;test.nc&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;array&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The content of a netCDF file can also be checked without reading the actual variables (only the axes), useful for large variables:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># checking</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">summary_nc</span><span class="p">(</span><span class="s">&quot;test.nc&quot;</span><span class="p">)</span>
<span class="go">test.nc:</span>
<span class="go">-------</span>
<span class="go">Dataset of 4 variables</span>
<span class="go">dimensions: &#39;time&#39;, &#39;lat&#39;, &#39;unnamed&#39;</span>
<span class="go">0 / time (2): 1950 to 1951</span>
<span class="go">1 / lat (3): -90.0 to 90.0</span>
<span class="go">2 / unnamed (3): timeseries to antarctica</span>
<span class="go">timeseries: (u&#39;time&#39;,)</span>
<span class="go">greenland: (u&#39;time&#39;, u&#39;lat&#39;)</span>
<span class="go">antarctica: (u&#39;time&#39;, u&#39;lat&#39;)</span>
<span class="go">array: (u&#39;unnamed&#39;, u&#39;time&#39;, u&#39;lat&#39;)</span>
</pre></div>
</div>
</div>
<div class="section" id="experimental-features">
<span id="id34"></span><h2>Experimental Features<a class="headerlink" href="#experimental-features" title="Permalink to this headline">¶</a></h2>
<div class="section" id="metadata">
<span id="id35"></span><h3>Metadata<a class="headerlink" href="#metadata" title="Permalink to this headline">¶</a></h3>
<p><cite>DimArray</cite> and <cite>Axis</cite> objects, support metadata. They can be passed by keyword arguments to DimArray (not via da.array_kw or DimArray.from_kw NOTE: may remove this functionality), or afterwards:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">DimArray</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;myname&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">units</span><span class="o">=</span><span class="s">&#39;myunits&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s">&quot;meters&quot;</span>
</pre></div>
</div>
<p>metadata are conserved by slicing and along-axis transformation, but are lost with any other transformation</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[:]</span><span class="o">.</span><span class="n">units</span>
<span class="go">&#39;myunits&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="p">[:]</span><span class="o">.</span><span class="n">units</span>
<span class="go">&#39;meters&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="compatibility-with-pandas-and-larry">
<span id="id36"></span><h3>Compatibility with pandas and larry<a class="headerlink" href="#compatibility-with-pandas-and-larry" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">[(</span><span class="s">&#39;items&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s">&#39;greenland&#39;</span><span class="p">,</span><span class="s">&#39;antarctica&#39;</span><span class="p">])),</span> <span class="p">(</span><span class="s">&#39;xx&#39;</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">dimarray: 6 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;items&#39;, &#39;xx&#39;</span>
<span class="go">0 / items (2): greenland to antarctica</span>
<span class="go">1 / xx (3): 2 to 4</span>
<span class="go">array([[0, 1, 2],</span>
<span class="go">       [3, 4, 5]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">xx          2  3  4</span>
<span class="go">items</span>
<span class="go">greenland   0  1  2</span>
<span class="go">antarctica  3  4  5</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">dimarray: 6 non-null elements (0 null)</span>
<span class="go">dimensions: &#39;items&#39;, &#39;xx&#39;</span>
<span class="go">0 / items (2): greenland to antarctica</span>
<span class="go">1 / xx (3): 2 to 4</span>
<span class="go">array([[0, 1, 2],</span>
<span class="go">       [3, 4, 5]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">to_larry</span><span class="p">()</span>
<span class="go">label_0</span>
<span class="go">    greenland</span>
<span class="go">    antarctica</span>
<span class="go">label_1</span>
<span class="go">    2</span>
<span class="go">    3</span>
<span class="go">    4</span>
<span class="go">x</span>
<span class="go">array([[0, 1, 2],</span>
<span class="go">       [3, 4, 5]])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="doctest-framework">
<span id="id37"></span><h2>doctest framework<a class="headerlink" href="#doctest-framework" title="Permalink to this headline">¶</a></h2>
<p>All docstring are tested for bugs with the <cite>doctest</cite> module. Additional tests are underway (but not there yet) to make things more systematic.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dimarray.tests</span> <span class="kn">as</span> <span class="nn">tests</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#import dimarray.tests as tests</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tests</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#run test.test_all()</span>
</pre></div>
</div>
<p>read from dimarray/io/testdata/test.nc</p>
<dl class="docutils">
<dt>dimarray/io/tests.py:25: UserWarning: writing as NETCDF3_CLASSIC failed (known bug on 64bits systems): RuntimeError(u&#8217;NetCDF: Not a valid data type or _FillValue type mismatch&#8217;,)</dt>
<dd>warn(&#8220;writing as NETCDF3_CLASSIC failed (known bug on 64bits systems): {msg}&#8221;.format(msg=repr(msg)))</dd>
</dl>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Old documentation</a><ul>
<li><a class="reference internal" href="#getting-started">Getting started</a></li>
<li><a class="reference internal" href="#under-the-hood">Under the hood</a></li>
<li><a class="reference internal" href="#axis-object">Axis object</a></li>
<li><a class="reference internal" href="#alternative-definitions-of-a-dimarray">Alternative definitions of a DimArray</a><ul>
<li><a class="reference internal" href="#automatic-naming">Automatic naming</a></li>
<li><a class="reference internal" href="#key-word-arguments">Key-word arguments</a></li>
</ul>
</li>
<li><a class="reference internal" href="#indexing">Indexing</a><ul>
<li><a class="reference internal" href="#basics-integer-array-slice">Basics: integer, array, slice</a></li>
<li><a class="reference internal" href="#modify-array-values">Modify array values</a></li>
<li><a class="reference internal" href="#take-and-put-methods">take and put methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#operations">Operations</a></li>
<li><a class="reference internal" href="#along-axis-transformations">Along-axis transformations</a><ul>
<li><a class="reference internal" href="#just-like-numpy-use-axis-name">Just like numpy. Use axis name !</a></li>
<li><a class="reference internal" href="#missing-values">Missing values</a></li>
<li><a class="reference internal" href="#weighted-mean-experimental">Weighted mean [experimental]</a></li>
</ul>
</li>
<li><a class="reference internal" href="#modify-array-shape">Modify array shape</a><ul>
<li><a class="reference internal" href="#transpose">transpose</a></li>
<li><a class="reference internal" href="#swapaxes">swapaxes</a></li>
<li><a class="reference internal" href="#group-and-ungroup-experimental">group and ungroup [experimental]</a></li>
<li><a class="reference internal" href="#reshape-experimental">reshape [experimental]</a></li>
</ul>
</li>
<li><a class="reference internal" href="#broadcast-dimensions">broadcast dimensions</a></li>
<li><a class="reference internal" href="#reindexing-align-axes">Reindexing: align axes</a><ul>
<li><a class="reference internal" href="#reindex-axis">reindex_axis</a></li>
<li><a class="reference internal" href="#reindex-like">reindex_like</a></li>
<li><a class="reference internal" href="#interpolation">Interpolation</a></li>
<li><a class="reference internal" href="#align-axes">align_axes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#stack-and-concatenate-arrays">Stack and concatenate arrays</a><ul>
<li><a class="reference internal" href="#concatenate-arrays-along-existing-axis">concatenate arrays along existing axis</a></li>
<li><a class="reference internal" href="#stack-arrays-along-new-axis">stack arrays along new axis</a></li>
<li><a class="reference internal" href="#broadcast-and-stack-arrays">broadcast and stack arrays</a></li>
<li><a class="reference internal" href="#aggregate-arrays-of-varying-dimensions-experimental">aggregate arrays of varying dimensions [Experimental]</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dataset">Dataset</a></li>
<li><a class="reference internal" href="#netcdf-i-o">NetCDF I/O</a></li>
<li><a class="reference internal" href="#experimental-features">Experimental Features</a><ul>
<li><a class="reference internal" href="#metadata">Metadata</a></li>
<li><a class="reference internal" href="#compatibility-with-pandas-and-larry">Compatibility with pandas and larry</a></li>
</ul>
</li>
<li><a class="reference internal" href="#doctest-framework">doctest framework</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="indexing.html"
                        title="previous chapter">Indexing</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../comparison.html"
                        title="next chapter">Comparisons with other packages</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/_build_rst/z_dimarray.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../comparison.html" title="Comparisons with other packages"
             >next</a> |</li>
        <li class="right" >
          <a href="indexing.html" title="Indexing"
             >previous</a> |</li>
        <li><a href="../index.html">dimarray 0.1.7.dev-62ca5fa documentation</a> &raquo;</li>
          <li><a href="index.html" >Documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Mahe Perrette.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.1.
    </div>
  </body>
</html>